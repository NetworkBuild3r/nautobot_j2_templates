{% set snmp_CTX = device.config_context.cisco_snmp_ios | default({}) %}
{% set mon_cfg = snmp_CTX.monitoring_config | default({}) %}
{% set snmp = mon_cfg.snmp | default({}) %}

{% if snmp and snmp is not none %}
! SNMP Configuration
! Device: {{ device.hostname | default("Unknown") }}

! SNMP Communities
{% if 'community_ro' in snmp and snmp['community_ro'] %}
snmp-server community {{ snmp['community_ro'] }} RO
{% endif %}
{% if 'community_rw' in snmp and snmp['community_rw'] %}
snmp-server community {{ snmp['community_rw'] }} RW
{% endif %}

! Contact & Location Information
{% if 'contact' in snmp and snmp['contact'] %}
snmp-server contact "{{ snmp['contact'] }}"
{% endif %}
{% if 'location' in snmp and snmp['location'] %}
snmp-server location "{{ snmp['location'] }}"
{% endif %}

! SNMP Traps Enablement
{% if 'enable_traps' in snmp and snmp['enable_traps'] %}
{% for trap in snmp['enable_traps'] %}
snmp-server enable traps {{ trap }}
{% endfor %}
{% endif %}

! Logging and Trap Host Configuration
{% if 'logging_host' in snmp and snmp['logging_host'] and 'community_ro' in snmp and snmp['community_ro'] %}
snmp-server host {{ snmp['logging_host'] }} version 2c {{ snmp['community_ro'] }}
{% endif %}
{% if 'trap_source' in snmp and snmp['trap_source'] %}
snmp-server trap-source {{ snmp['trap_source'] }}
{% endif %}
{% if 'logging_source_interface' in snmp and snmp['logging_source_interface'] %}
logging source-interface {{ snmp['logging_source_interface'] }}
{% endif %}

! SNMP Access Control List - ACL51
{% if 'acl_51' in snmp and snmp['acl_51'] %}
ip access-list standard ACL51
{% for entry in snmp['acl_51'] %}
 {{ entry }}
{% endfor %}
{% endif %}

! SNMP Access Control List - ACL60
{% if 'acl_60' in snmp and snmp['acl_60'] %}
ip access-list standard ACL60
{% for entry in snmp['acl_60'] %}
 {{ entry }}
{% endfor %}
{% endif %}

! Additional SNMP Hosts
{% if 'hosts' in snmp and snmp['hosts'] %}
{% for host in snmp['hosts'] %}
{% if 'ip' in host and host['ip'] and 'community' in host and host['community'] %}
snmp-server host {{ host['ip'] }} version 2c {{ host['community'] }}
{% endif %}
{% endfor %}
{% endif %}

{% else %}
! SNMP Configuration Error
! No valid SNMP data found in config_context
{% endif %}